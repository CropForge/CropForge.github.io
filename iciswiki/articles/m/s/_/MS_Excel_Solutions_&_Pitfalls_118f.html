<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.14.0" />
		<meta name="keywords" content="MS Excel Solutions &amp; Pitfalls" />
		<link rel="shortcut icon" href="../../../../misc/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="../../../../../opensearch_desc.php" title="ICISWiki (en)" />
		<link title="Creative Commons" type="application/rdf+xml" href="../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html" rel="alternate meta" />
		<link rel="copyright" href="../../../../../COPYING.html" />
		<link rel="alternate" type="application/rss+xml" title="ICISWiki RSS Feed" href="http://localhost../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" />
		<link rel="alternate" type="application/atom+xml" title="ICISWiki Atom Feed" href="http://localhost../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" />
		<title>MS Excel Solutions &amp; Pitfalls - ICISWiki</title>
		<link rel="stylesheet" href="../../../../skins/common/shared.css?195" type="text/css" media="screen" />
		<link rel="stylesheet" href="../../../../skins/common/commonPrint.css?195" type="text/css" media="print" />
		<link rel="stylesheet" href="../../../../skins/monobook/main.css?195" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="../../../../skins/monobook/IE50Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="../../../../skins/monobook/IE55Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="../../../../skins/monobook/IE60Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="../../../../skins/monobook/IE70Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7ECommon.css?195" type="text/css" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7EPrint.css?195" type="text/css" media="print" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7EMonobook.css?195" type="text/css" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/gen.css?195" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="../../../../skins/common/IEFixes.js?195"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "../../../../skins";
		var wgArticlePath = "../../../../$1";
		var wgScriptPath = "../../../../..";
		var wgScript = "/icis/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://localhost";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "MS_Excel_Solutions_\x26_Pitfalls";
		var wgTitle = "MS Excel Solutions \x26 Pitfalls";
		var wgAction = "view";
		var wgArticleId = "2922";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = "8505";
		var wgVersion = "1.14.0";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="../../../../skins/common/wikibits.js?195"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="../../../../raw/gen.js"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-MS_Excel_Solutions_Pitfalls skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">MS Excel Solutions &amp; Pitfalls</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From ICISWiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p>This section of the ICIS Wiki is primarily intended for future developers of the ICISworkbook (if it remains to be in Excel of course) to have a stronger foundation on which to lay their own innovations, and continue the legacy of the application as being both user-friendly and fast.  This is also intended for end-users, for them to marvel at the beauty of how their simple wish list was actually granted.  And for the warring forces of MS Devotees, Mac Minions, and Open Sourcerers, to give them more reasons to fight, thereby keeping the technological balance in cyberspace…  May the force be with you all!
</p><p><br />
The DMS Workbook, as it was originally named, was built on MS Excel macros for the basic reason that users have been using Excel since the day they were born.  I mean… you got the idea!  And so it was that the needed functions for the Workbook were one by one realized.  At first, there was joy and peace, and contentment was in everyone’s heart. Until, the land and water dedicated for rice field grew smaller and smaller, and the global threat to food security became clearer and clearer, and the search for a solution grew stronger and stronger, and thus research became broader and broader, and so the data grew bigger and bigger! and the… Stop!!...  inhale… exhale… until the Workbook became soo… slowww…
</p><p><br />
Thus, the Workbook must be improved!  And here we are now, on a heroic journey to save the world!  Ahm… maybe that was too ambitious.  This is the start of putting into account the experiences of the few, the brave, the proud… (Will you just cut that out!) developers of the ICISworkbook.  For many were called, but few were hired.  Budget constraints, you know.
</p><p><br />
Seriously, this ICIS Wiki section aims to record the solutions taken to improve the ICISworkbook, as well as the pitfalls, as they may seem to be at the time they are first recorded here, which could probably be easily solved by any of you.  Thus, there is no claim whatsoever of the superiority of any of the solutions as well as the difficulty of the pitfalls.  May this be an open invitation for alternative approaches and foreseen problems for the betterment of the ICISworkbook application.
</p><p><br />
</p>
<a name="Workbook.Open_vs._Workbook.OpenText" id="Workbook.Open_vs._Workbook.OpenText"></a><h1> <span class="mw-headline">Workbook.Open vs. Workbook.OpenText</span></h1>
<p>As it was quite established for some time now, moving up and down, left to right, or whatever, on the rows and columns of a worksheet has a bit of an overhead in processing time.  So the recommended solution was to use a text file.  And so it was that the ICISworkbook was rewritten to traverse a tab-delimited text file.  And a record speed of ten times faster than threading a worksheet was achieved, blah-blah-blah…  But let’s get into the details of how it was actually done shall we?  Both the Description and Observation sheets are saved as a tab-delimited text file.  This is a pretty simple one line of code as “ActiveWorkbook.SaveAs Filename:=zSomeFileName, FileFormat:=xlText”.  Then, we access the contents of each cell by looking for the tab character <i>Chr(9)</i> which marks the boundaries of the columns, and the carriage return + line feed characters <i>Chr(13) &amp; Chr(10)</i> marking the end of a row.  But this process corresponds only to reading the worksheet or, in a more familiar term, loading a study.  For retrieving a study, we have to do the reverse.  That is writing to a text file then converting it to a worksheet.  This will be the topic of this particular discussion.  Now, the series of images below will explain the two Workbook methods that were used, and their advantages and disadvantages as well.
</p><p><br />
Given the freedom to use a carriage return inside a cell by pressing the <i>Alt + Enter</i> keys simultaneously, we’ll have the situation below:
</p><p><a href="../../../../articles/t/1/-/File%7ET1-01.png_5e35.html" class="image" title="Image:T1-01.png"><img alt="Image:T1-01.png" src="../../../../images/7/7b/T1-01.png" width="925" height="490" border="0" /></a>
</p><p><br />
Earlier versions of the ICISworkbook that started using text files and up to version 5.5.0.2 use the <b>Workbook.Open</b> method to view the text file in the multi-document interface of MS Excel.  Again, this is a one line of code, letting Excel do the dirty work of file conversion.  And it did pretty good, really.  It knows what string of characters belong to which cell.  And in case of special characters, double quotes where used to contain them when the file was saved.  Same interpretation was done when the file was read, perfect!  But the problem comes in when Excel automatically determines the data type of the cell contents.  It generously converts for you every date-looking string into the equivalent date format.  Oh-ow!!...
</p><p><a href="../../../../articles/t/1/-/File%7ET1-02.png_ac46.html" class="image" title="Image:T1-02.png"><img alt="Image:T1-02.png" src="../../../../images/8/86/T1-02.png" width="925" height="573" border="0" /></a>
</p><p><br />
So, complaints came pouring in, "I loaded a range value of 1-2, when I retrieved it, it became a date value 2-Jan?!  That's outrageous!! (sorry, exaggeration was mine&nbsp;:-)"  So, we went back to our thinking chair... Hmm??... Hmm???...  Press F1... Aha!! <b>Workbook.OpenText</b> allows you to declare the data type for each column.  And so it was that version... Well, actually the first change started in version 5.4.1 in the <i>Retrieve Study</i> function but it was later propagated to the <i>Import Data From SetGen</i> function in version 5.5.0.3 which was used as an example in these images so just bear with me please, okay?&nbsp;:-D
</p><p><br />
But wait! There's more!!  I mean, there's a problem.  Workbook.OpenText doesn't recognize the power of double quotes to restrain the interpretation of a carriage return inside a cell.  The carriage return becomes interpreted as an end-of-line.  Thus, the line or row in the text file prematurely breaks into another row.  Ouch!
</p><p><a href="../../../../articles/t/1/-/File%7ET1-03.png_7d3e.html" class="image" title="Image:T1-03.png"><img alt="Image:T1-03.png" src="../../../../images/8/8d/T1-03.png" width="925" height="828" border="0" /></a>
</p><p><br />
And so, because the ROWTAG column was temporarily placed in front, it received the other part of the broken line.  And you know what happens if there's a value under the ROWTAG column, the whole row becomes interpreted as a remark instead of an observation.  Thus, when the code execution gets to the part pictured below, some side effect occurs which somehow hides the true error and makes you wonder, "Gosh! Why am I seeing double??  I must be hungry now, time for a coffee break."  Well, errors ain't that bad after all, eh?
</p><p><a href="../../../../articles/t/1/-/File%7ET1-04.png_835a.html" class="image" title="Image:T1-04.png"><img alt="Image:T1-04.png" src="../../../../images/8/8e/T1-04.png" width="927" height="1000" border="0" /></a>
</p><p><br />
At this point you might be wondering what I did to solve the problem?  Well, with all the time I spent writing this whole article, I did nothing but just talk about it&nbsp;:-D.  Sorry, one task at a time, please.  But realizing the problem and knowing that it all started with a carriage return inside a cell, the big question is "To fix? Or not to fix?"  With not to fix, I mean just don't use a carriage return inside a cell.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 2/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->
<div class="printfooter">
Retrieved from "<a href="http://localhost../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html">http://localhost../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="../../../../articles/m/s/_/Talk%7EMS_Excel_Solutions_%26_Pitfalls_23a3.html" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="../../../../articles/u/s/e/Special%7EUserLogin_94cd.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../../../../misc/icis-wiki3.png);" href="../../../../index.html" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="../../../../index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
				<li id="n-portal"><a href="../../../../articles/c/o/m/ICISWiki%7ECommunity_Portal_7449.html" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="../../../../articles/s/e/a/Special%7ESearch_a8e5.html" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search ICISWiki [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="../../../../articles/w/h/a/Special%7EWhatLinksHere_MS_Excel_Solutions_%26_Pitfalls_b6de.html" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="../../../../articles/r/e/c/Special%7ERecentChangesLinked_MS_Excel_Solutions_%26_Pitfalls_16c4.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="../../../../articles/s/p/e/Special%7ESpecialPages_f12b.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="../../../../articles/m/s/_/MS_Excel_Solutions_%26_Pitfalls_118f.html" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="/icis/skins/common/images/gnu-fdl.png" alt='GNU Free Documentation License 1.2' /></a></div>
			<ul id="f-list">
					<li id="credits">This page was last modified 06:26, 7 August 2007 by <a href="../../../../articles/w/c/o/User%7EWconstantino_4eab.html" title="User:Wconstantino">Warren Vincent Constantino</a>. </li>
					<li id="copyright">Content is available under <a href="../../../../../COPYING.html" class="external " title="../../../../../COPYING.html">GNU Free Documentation License 1.2</a>.</li>
					<li id="privacy"><a href="../../../../articles/p/r/i/ICISWiki%7EPrivacy_policy_0cbf.html" title="ICISWiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="../../../../articles/a/b/o/ICISWiki%7EAbout_53aa.html" title="ICISWiki:About">About ICISWiki</a></li>
					<li id="disclaimer"><a href="../../../../articles/g/e/n/ICISWiki%7EGeneral_disclaimer_9129.html" title="ICISWiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 207.838 secs. --></body></html>
