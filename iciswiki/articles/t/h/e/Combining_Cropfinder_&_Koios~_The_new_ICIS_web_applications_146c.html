<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.14.0" />
		<meta name="keywords" content="Combining Cropfinder &amp; Koios: The new ICIS web applications,January 16, 2009 Meeting in IRRI for the setup of ICIS Web in CIMMYT and UQ servers" />
		<link rel="shortcut icon" href="../../../../misc/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="../../../../../opensearch_desc.php" title="ICISWiki (en)" />
		<link title="Creative Commons" type="application/rdf+xml" href="../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html" rel="alternate meta" />
		<link rel="copyright" href="../../../../../COPYING.html" />
		<link rel="alternate" type="application/rss+xml" title="ICISWiki RSS Feed" href="http://localhost../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" />
		<link rel="alternate" type="application/atom+xml" title="ICISWiki Atom Feed" href="http://localhost../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" />
		<title>Combining Cropfinder &amp; Koios: The new ICIS web applications - ICISWiki</title>
		<link rel="stylesheet" href="../../../../skins/common/shared.css?195" type="text/css" media="screen" />
		<link rel="stylesheet" href="../../../../skins/common/commonPrint.css?195" type="text/css" media="print" />
		<link rel="stylesheet" href="../../../../skins/monobook/main.css?195" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="../../../../skins/monobook/IE50Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="../../../../skins/monobook/IE55Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="../../../../skins/monobook/IE60Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="../../../../skins/monobook/IE70Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7ECommon.css?195" type="text/css" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7EPrint.css?195" type="text/css" media="print" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7EMonobook.css?195" type="text/css" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/gen.css?195" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="../../../../skins/common/IEFixes.js?195"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "../../../../skins";
		var wgArticlePath = "../../../../$1";
		var wgScriptPath = "../../../../..";
		var wgScript = "/icis/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://localhost";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Combining_Cropfinder_\x26_Koios:_The_new_ICIS_web_applications";
		var wgTitle = "Combining Cropfinder \x26 Koios: The new ICIS web applications";
		var wgAction = "view";
		var wgArticleId = "3677";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = "15884";
		var wgVersion = "1.14.0";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="../../../../skins/common/wikibits.js?195"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="../../../../raw/gen.js"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Combining_Cropfinder_Koios_The_new_ICIS_web_applications skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Combining Cropfinder &amp; Koios: The new ICIS web applications</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From ICISWiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Background"><span class="tocnumber">1</span> <span class="toctext">Background</span></a></li>
<li class="toclevel-1"><a href="#Implementation"><span class="tocnumber">2</span> <span class="toctext">Implementation</span></a></li>
<li class="toclevel-1"><a href="#Minutes_of_meetings"><span class="tocnumber">3</span> <span class="toctext">Minutes of meetings</span></a></li>
<li class="toclevel-1"><a href="#Implementation_Details"><span class="tocnumber">4</span> <span class="toctext">Implementation Details</span></a>
<ul>
<li class="toclevel-2"><a href="#MySQL_Setup:_Some_notes..."><span class="tocnumber">4.1</span> <span class="toctext">MySQL Setup: Some notes...</span></a></li>
<li class="toclevel-2"><a href="#Database_Setup"><span class="tocnumber">4.2</span> <span class="toctext">Database Setup</span></a>
<ul>
<li class="toclevel-3"><a href="#1._.22Base.22_ICIS_tables"><span class="tocnumber">4.2.1</span> <span class="toctext">1. "Base" ICIS tables</span></a></li>
<li class="toclevel-3"><a href="#2._MySQL_stored_procedures_for_retrieving_datasets_.28under_reconsideration.29"><span class="tocnumber">4.2.2</span> <span class="toctext">2. MySQL stored procedures for retrieving datasets (under reconsideration)</span></a></li>
<li class="toclevel-3"><a href="#3._Cropfinder_tables_FACTORS_and_FIELDSETUP"><span class="tocnumber">4.2.3</span> <span class="toctext">3. Cropfinder tables FACTORS and FIELDSETUP</span></a>
<ul>
<li class="toclevel-4"><a href="#FIELDSETUP"><span class="tocnumber">4.2.3.1</span> <span class="toctext">FIELDSETUP</span></a></li>
<li class="toclevel-4"><a href="#FACTORS"><span class="tocnumber">4.2.3.2</span> <span class="toctext">FACTORS</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2"><a href="#Setup_user_privileges"><span class="tocnumber">4.3</span> <span class="toctext">Setup user privileges</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Proposed_data_warehousing_for_ICIS_Core_and_Cropfinder"><span class="tocnumber">5</span> <span class="toctext">Proposed data warehousing for ICIS Core and Cropfinder</span></a>
<ul>
<li class="toclevel-2"><a href="#Meetings.2FVCs"><span class="tocnumber">5.1</span> <span class="toctext">Meetings/VCs</span></a>
<ul>
<li class="toclevel-3"><a href="#Feb_5.2C_2009"><span class="tocnumber">5.1.1</span> <span class="toctext">Feb 5, 2009</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Implementation_2"><span class="tocnumber">5.2</span> <span class="toctext">Implementation</span></a>
<ul>
<li class="toclevel-3"><a href="#MySQL_stored_procedures"><span class="tocnumber">5.2.1</span> <span class="toctext">MySQL stored procedures</span></a>
<ul>
<li class="toclevel-4"><a href="#Part_1:_Setup_user_privileges_for_accessing_stored_procedures"><span class="tocnumber">5.2.1.1</span> <span class="toctext">Part 1: Setup user privileges for accessing stored procedures</span></a></li>
<li class="toclevel-4"><a href="#Part_2:_Setup_the_data"><span class="tocnumber">5.2.1.2</span> <span class="toctext">Part 2: Setup the data</span></a></li>
</ul>
</li>
<li class="toclevel-3"><a href="#Part_3:_Sort_the_records_.28according_to_one_column.3B_user-driven.29"><span class="tocnumber">5.2.2</span> <span class="toctext">Part 3: Sort the records (according to one column; user-driven)</span></a></li>
<li class="toclevel-3"><a href="#Details"><span class="tocnumber">5.2.3</span> <span class="toctext">Details</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="#More_information_.28GCP_website.29"><span class="tocnumber">6</span> <span class="toctext">More information (GCP website)</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Background" id="Background"></a><h2> <span class="mw-headline"> Background </span></h2>
<p>Discussion from ICIS Developers' Workshop 2008 @ IRRI:
</p>
<dl><dd><ul><li> KOIOS track, very general query engine, at this moment PER STUDY 
</li><li> CROPFINDER different approach, (re) structures the ICIS database, builds a warehouse table, with a field for every variable: trait-scale-methods. Can query ACROSS studies.
</li></ul>
</dd></dl>
<p><b>Conclusion:</b> We should finish up with 1 interface that combines both items (technique from KOIOS and functionalities from CROPFINDER)
</p>
<a name="Implementation" id="Implementation"></a><h2> <span class="mw-headline"> Implementation </span></h2>
<p>The pre-alpha release can be accessed here: <a href="http://seeds.irri.org/iris/index.php/palpha/48-studybrowser" class="external free" title="http://seeds.irri.org/iris/index.php/palpha/48-studybrowser" rel="nofollow">http://seeds.irri.org/iris/index.php/palpha/48-studybrowser</a>
</p>
<a name="Minutes_of_meetings" id="Minutes_of_meetings"></a><h2> <span class="mw-headline"> Minutes of meetings </span></h2>
<p><a href="../../../../articles/j/a/n/January_16,_2009_Meeting_in_IRRI_for_the_setup_of_ICIS_Web_in_CIMMYT_and_UQ_servers_4f87.html" title="January 16, 2009 Meeting in IRRI for the setup of ICIS Web in CIMMYT and UQ servers">January 16, 2009 Meeting in IRRI for the setup of ICIS Web in CIMMYT and UQ servers</a>
</p>
<a name="Implementation_Details" id="Implementation_Details"></a><h2> <span class="mw-headline"> Implementation Details</span></h2>
<a name="MySQL_Setup:_Some_notes..." id="MySQL_Setup:_Some_notes..."></a><h3> <span class="mw-headline"> MySQL Setup: Some notes... </span></h3>
<dl><dd>1. Use MyISAM as the storage engine (specified in database table definitions).
</dd><dd>2. Increase the value of <b>max_connections</b> Mysql system variable (in my.cnf) to <i><b>greater than 100</b></i> (100 is the default).
</dd></dl>
<a name="Database_Setup" id="Database_Setup"></a><h3> <span class="mw-headline"> Database Setup  </span></h3>
<p>The examples shown below are for using the MySQL command prompt. Alternatively, the same processes may be done using a GUI tool. 
</p>
<a name="1._.22Base.22_ICIS_tables" id="1._.22Base.22_ICIS_tables"></a><h4> <span class="mw-headline"> 1. "Base" ICIS tables  </span></h4>
<p>"Base" included in the <a href="http://cropforge.org/frs/?group_id=5&amp;release_id=427" class="external text" title="http://cropforge.org/frs/?group_id=5&amp;release_id=427" rel="nofollow">standard ICIS Schema</a> (used by standalone applications). 
</p><p>1. Login remotely (via SSH) to Mysql on the server. Example: 
</p>
<pre>   mysql -usomeusername -p
</pre>
<p>2. Create empty databases. Example: 
</p>
<pre>   mysql&gt; CREATE DATABASE iris_myisam CHARACTER SET utf8 COLLATE utf8_general_ci;
   mysql&gt; CREATE DATABASE imis_myisam CHARACTER SET utf8 COLLATE utf8_general_ci;
   mysql&gt; CREATE DATABASE iwis3_myisam CHARACTER SET utf8 COLLATE utf8_general_ci;
</pre>
<p><i>where: iris_myisam is the database for RICE data, imis_myisam for MAIZE data, and iwis3_myisam for WHEAT data</i> 
</p><p>3. Populate the databases. Example: 
</p>
<pre>   mysql&gt; use iris_myisam;
   mysql&gt; source /home/someusername/iris_myisam_data.sql;
</pre>
<pre>   mysql&gt; use imis_myisam;
   mysql&gt; source /home/someusername/imis_myisam_data.sql;
</pre>
<pre>   mysql&gt; use iwis3_myisam;
   mysql&gt; source /home/someusername/iwis3_myisam_data.sql;
</pre>
<a name="2._MySQL_stored_procedures_for_retrieving_datasets_.28under_reconsideration.29" id="2._MySQL_stored_procedures_for_retrieving_datasets_.28under_reconsideration.29"></a><h4> <span class="mw-headline"> 2. MySQL stored procedures for retrieving datasets <font color="red">(under reconsideration)</font> </span></h4>
<p>4. Create procedure <b>get_dataset</b>. Run this <a href="http://cropwiki.irri.org/icis/images/b/b4/Get_dataset.sql" class="external text" title="http://cropwiki.irri.org/icis/images/b/b4/Get_dataset.sql" rel="nofollow">SQL file</a> on each database. Creates a warehouse table containing data for one study. Example: 
</p>
<pre>  mysql&gt; use iris_myisam;
  mysql&gt; source /home/someusername/get_dataset.sql;
</pre>
<pre>  mysql&gt; use imis_myisam;
  mysql&gt; source /home/someusername/get_dataset.sql;
</pre>
<pre>  mysql&gt; use iwis3_myisam;
  mysql&gt; source /home/someusername/get_dataset.sql;
</pre>
<p>5. Create procedure <b>get_all_dataset</b>. Run this <a href="http://cropwiki.irri.org/icis/images/2/2f/Get_all_dataset.sql" class="external text" title="http://cropwiki.irri.org/icis/images/2/2f/Get_all_dataset.sql" rel="nofollow">SQL file</a> on each database. <font color="red">This procedure has to be CALLed manually.</font> Creates warehouse tables containing data for multiple studies (one table per study). 
</p>
<pre>  mysql&gt; use iris_myisam;
  mysql&gt; source /home/someusername/get_all_dataset.sql;
</pre>
<pre>  mysql&gt; use iwis3_myisam;
  mysql&gt; source /home/someusername/get_all_dataset.sql;
</pre>
<pre>  mysql&gt; use imis_myisam;
  mysql&gt; source /home/someusername/get_all_dataset.sql;
</pre>
<a name="3._Cropfinder_tables_FACTORS_and_FIELDSETUP" id="3._Cropfinder_tables_FACTORS_and_FIELDSETUP"></a><h4> <span class="mw-headline"> 3. Cropfinder tables FACTORS and FIELDSETUP  </span></h4>
<p>As of this writing, only 2 CropFinder tables are being used by the new ICIS/Koios web application. 
</p>
<a name="FIELDSETUP" id="FIELDSETUP"></a><h5> <span class="mw-headline"> FIELDSETUP  </span></h5>
<p>The original FIELDSETUP table (from CropFinder) was modified for integration into the new Koios/ICIS web architecture. 
</p><p>The MySQL stored procedure that creates &amp; populates the FIELDSETUP table is <a href="http://cropwiki.irri.org/icis/images/7/7d/Fieldsetup_20090328.sql" class="external text" title="http://cropwiki.irri.org/icis/images/7/7d/Fieldsetup_20090328.sql" rel="nofollow">here</a>. <font color="red">This has to be CALLed manually.</font> 
</p><p>Usage: 
</p>
<pre>  call create_fieldsetup(<i>param1</i>,<i>param2</i>);
</pre>
<p>where <i>param1</i> = name of the crop ('RICE', 'WHEAT', or 'MAIZE'), <i>param2</i> = name of the database 
</p><p>Example: 
</p>
<pre>  mysql&gt; use iris_myisam;
  mysql&gt; call create_fieldsetup('RICE','iris_myisam');
</pre>
<pre>  mysql&gt; use iwis3_myisam;
  mysql&gt; call create_fieldsetup('WHEAT','iwis3_myisam');
</pre>
<pre>  mysql&gt; use imis_myisam;
  mysql&gt; call create_fieldsetup('MAIZE','imis_myisam');
</pre>
<p><br /> 
</p>
<ul><li><b>Structural changes:</b>
</li></ul>
<p><a href="../../../../articles/f/i/e/File%7EFieldsetup_changes.JPG_a906.html" class="image" title="Fieldsetup changes.JPG"><img alt="" src="../../../../images/thumb/3/33/Fieldsetup_changes.JPG/600px-Fieldsetup_changes.JPG" width="600" height="450" border="0" /></a> 
</p>
<dl><dd>Summary: 
<dl><dd>1. Length of columns FIELDNAME, FIELDTEXT, TABLEALIAS increased to 255. 
</dd><dd>2. Column TMETHID added <i>(to handle the trait-scale-method definitions in ICIS)</i>
</dd></dl>
</dd></dl>
<p><br /> 
</p>
<ul><li><b>Data changes (.SQL file for populating data):</b>
</li></ul>
<p><i>Changes were requested by the ICIS Java backend team.</i> 
</p>
<table cellpadding="2" border="0" style="background: rgb(208, 208, 208) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 1040px; height: 497px;">

<tr style="background: rgb(208, 208, 208) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<th align="left"> Value of "GROUPOFTRAITS" column in FIELDSETUP table
</th><td> Column in FIELDSETUP table
</td><td> Original format
</td><td> Modified format (as of Mar 27, 2009)
</td></tr>
<tr style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<th align="left" rowspan="4"> "Traits"
</th><td> <font color="green"><b>fieldname</b></font>
</td><td> "dvalue"
</td><td style="background: rgb(255, 255, 204) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"> TRAITNAME_SCALENAME_METHODNAME
</td></tr>
<tr style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<td> fieldtext
</td><td> TRAITNAME<font color="red"><b>_</b></font>SCALENAME
<p><i>(then truncated to 50 characters max only)</i> 
</p>
</td><td style="background: rgb(255, 255, 204) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"> TRAITNAME<font color="red"><b>_</b></font>SCALENAME<font color="red"><b>_METHODNAME.</b></font>VARIATEID
<p><i>(where VARIATEID = cast(variatid as char))</i> 
</p><p><font color="blue">--&gt; no truncation</font> 
</p>
</td></tr>
<tr style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<td> fieldid
</td><td> (autonumber)
<p><i>1 to etc...unique, sequential</i> 
</p>
</td><td style="background: rgb(255, 255, 204) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"> unique VARIATEID
<p><i>(where VARIATEID = variatid from "variate" table)</i> 
</p>
</td></tr>
<tr style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<td> tablealias
</td><td>
<ul><li>If datatype = 'Text': data_c<font color="red"><b>_</b></font><font color="green"><b>fieldname</b></font> 
</li><li>If datatype = 'Real': data_n<font color="red"><b>_</b></font><font color="green"><b>fieldname</b></font>
</li></ul>
<p><i>(then truncated to 50 characters max only)</i> 
</p>
</td><td style="background: rgb(255, 255, 204) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<ul><li>If datatype = 'Text': data_c<font color="red"><b>_</b></font><font color="green"><b>fieldname</b></font> 
</li><li>If datatype = 'Real': data_n<font color="red"><b>_</b></font><font color="green"><b>fieldname</b></font>
</li></ul>
<p><font color="blue">--&gt; no truncation</font> 
</p>
</td></tr>
<tr style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<th align="left" rowspan="2"> "Factors"
</th><td> fieldtext
</td><td> FACTORNAME
</td><td style="background: rgb(255, 255, 204) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"> FACTORNAME<font color="red"><b>.</b></font>LABELID
<p><i>(where LABELID = cast(labelid as char))</i> 
</p><p><br /> 
</p>
</td></tr>
<tr style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<td> fieldid
</td><td> (autonumber)
<p><i>1 to etc...unique, sequential</i> 
</p>
</td><td style="background: rgb(255, 255, 204) none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"> unique LABELID
<p><i>(where LABELID = labelid from "factor" table)</i> 
</p>
</td></tr></table>
<p><br />
</p>
<a name="FACTORS" id="FACTORS"></a><h5> <span class="mw-headline"> FACTORS  </span></h5>
<p>The MySQL stored procedure that creates &amp; populates the FACTORS table is <a href="http://cropwiki.irri.org/icis/images/d/d6/Factors_20090328.sql" class="external text" title="http://cropwiki.irri.org/icis/images/d/d6/Factors_20090328.sql" rel="nofollow">here</a>. <font color="red">This has to be CALLed manually.</font> 
</p><p>Usage: 
</p>
<pre>  call create_factors(<i><font color="purple">param1</font></i>,<i><font color="green">param2</font></i>);
</pre>
<p>...where: <br /> 
</p>
<dl><dd><i><font color="purple">param1</font></i> = name of the crop ('RICE', 'WHEAT', or 'MAIZE'), <br /> 
</dd><dd><i><font color="green">param2</font></i> = name of the database
</dd></dl>
<p>Example: 
</p>
<pre>  mysql&gt; use iris_myisam;
  mysql&gt; call create_factors('RICE','iris_myisam');
</pre>
<pre>  mysql&gt; use iwis3_myisam;
  mysql&gt; call create_factors('WHEAT','iwis3_myisam');
</pre>
<pre>  mysql&gt; use imis_myisam;
  mysql&gt; call create_factors('MAIZE','imis_myisam');
</pre>
<a name="Setup_user_privileges" id="Setup_user_privileges"></a><h3> <span class="mw-headline"> Setup user privileges <br />  </span></h3>
<p><i><b>(Done by admin/root user only)</b></i>
</p>
<dl><dd>1. Create a MySQL user called <b>datasourceuser</b>
</dd></dl>
<pre>mysql&gt; CREATE USER 'datasourceuser'@'%' identified by 'somepassword';
</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp; 2. Grant privileges to user <b>datasourceuser</b>: 
</p>
<pre>mysql&gt; GRANT SELECT on iris_myisam.* TO 'datasourceuser'@'%' IDENTIFIED BY 'somepassword';
mysql&gt; GRANT SELECT on iwis3_myisam.* TO 'datasourceuser'@'%' IDENTIFIED BY 'somepassword';
mysql&gt; GRANT SELECT on imis_myisam.* TO 'datasourceuser'@'%' IDENTIFIED BY 'somepassword';
</pre>
<a name="Proposed_data_warehousing_for_ICIS_Core_and_Cropfinder" id="Proposed_data_warehousing_for_ICIS_Core_and_Cropfinder"></a><h2> <span class="mw-headline"> Proposed data warehousing for ICIS Core and Cropfinder  </span></h2>
<a name="Meetings.2FVCs" id="Meetings.2FVCs"></a><h3> <span class="mw-headline"> Meetings/VCs  </span></h3>
<a name="Feb_5.2C_2009" id="Feb_5.2C_2009"></a><h4> <span class="mw-headline"> Feb 5, 2009  </span></h4>
<p>Summary by M.Senger: 
</p><p><b>Warehouse Tables</b> 
</p><p>The warehouse tables are both in the core ICIS (by "core ICIS" I do not mean the regular ICIS but in ICIS used by the GCP data sources) and in the CropFinder ICIS. In both cases, their structure (number of table columns) depends on the data (some data require less columns, some more). Because this dependency causes problems (so far seen in the core ICIS but theoretically may happen also in the CropFinder ICIS), we moved to replicate the current warehouse tables (in the core ICIS) by one of the following solution: 
</p><p><b>...</b> 
</p><p>... 
</p><p>... 
</p>
<dl><dd><font color="blue">2) Use the Thomas's warehouse tables. This solution was accepted for trying.</font> So far nobody sees any problem with it. Ching is going to write a script populating these tables and Jeffrey will adapt the ICIS data source to read from these tables. Hopefully both will happen before the next VC next Wed/Thu. There was a suggestion to use only one column for values (VARCHAR type), not two as in the Thomas's original proposal. Thomas was not available to comment on it. Ching and Jeffrey is going to try with the single value column.
</dd></dl>
<a name="Implementation_2" id="Implementation_2"></a><h3> <span class="mw-headline"> Implementation  </span></h3>
<a name="MySQL_stored_procedures" id="MySQL_stored_procedures"></a><h4> <span class="mw-headline"> MySQL stored procedures  </span></h4>
<p><a href="http://cropwiki.irri.org/icis/images/b/bc/Wh_tables_20090331.sql" class="external text" title="http://cropwiki.irri.org/icis/images/b/bc/Wh_tables_20090331.sql" rel="nofollow">This .SQL file</a> contains the following stored procedures (and respective sub-procedures of each): 
</p>
<dl><dd>1. initialize_warehouse 
</dd><dd>2. get_all_dataset_warehouses 
</dd><dd>3. addindices_warehouse 
</dd><dd>4. sort_warehouse
</dd></dl>
<p>Run this file on each database. 
</p><p><br /> 
</p>
<a name="Part_1:_Setup_user_privileges_for_accessing_stored_procedures" id="Part_1:_Setup_user_privileges_for_accessing_stored_procedures"></a><h5> <span class="mw-headline"> <font color="blue">Part 1: Setup user privileges for accessing stored procedures </font>  </span></h5>
<p><i><b>(Done by admin/root user only) <font color="blue"></font></b></i><br /> 
</p><p>Grant EXECUTE privileges for user <b>datasourceuser</b> ON procedure <b>sort_warehouse</b>(). <br /> 
</p>
<pre>mysql&gt; GRANT EXECUTE ON PROCEDURE iris_myisam.sort_warehouse to 'datasourceuser'@'%' IDENTIFIED BY 'somepassword';
</pre>
<a name="Part_2:_Setup_the_data" id="Part_2:_Setup_the_data"></a><h5> <span class="mw-headline"> <font color="blue">Part 2: Setup the data</font>  </span></h5>
<p><b>USAGE:</b> 
</p>
<pre>CALL initialize_warehouse();    <i>-- creates the tables <b>wh_datasets</b>, <b>wh_columns</b>, <b>wh_data</b></i>

</pre>
<p><br /> 
</p>
<pre>CALL get_all_dataset_warehouses(<font color="red">param1</font>,<font color="purple">param2</font>,<font color="green">param3</font>);   
</pre>
<p>...where: 
</p>
<dl><dd><i><font color="red">param1</font></i> = starting Study ID (inclusive), <br /> 
</dd><dd><i><font color="blue">param2</font></i> = ending Study ID (inclusive), <br /> 
</dd><dd><i><font color="green">param3</font></i> = name of database (e.g.: 'iris_myisam')
</dd></dl>
<p><br /> 
</p>
<pre>CALL addindices_warehouse();    <i>-- run this procedure after <font color="red">ALL</font> data has been populated. </i>
				<i>-- This deletes NULL data values in the WH_DATA table </i>
                               <i>-- and creates the required indices for faster querying.</i>
</pre>
<p><br />
</p>
<a name="Part_3:_Sort_the_records_.28according_to_one_column.3B_user-driven.29" id="Part_3:_Sort_the_records_.28according_to_one_column.3B_user-driven.29"></a><h4> <span class="mw-headline"> <font color="blue">Part 3: Sort the records (according to one column; user-driven)</font>  </span></h4>
<p>This sorting procedure may used for sorting within one dataset, or across all datasets. 
</p><p><b>USAGE:</b> 
</p>
<pre>CALL sort_warehouse(<i><font color="red">param1</font></i>,<i><font color="purple">param2</font></i>,<i><font color="green">param3</font></i>,<i><font color="orange">param4</font></i>,<i><font color="navy">param5</font></i>,<i><font color="brown">param6</font></i>);
</pre>
<p>...where: 
</p>
<dl><dd><i><font color="red">param1</font></i> = Trait ID,
</dd></dl>
<dl><dd><i><font color="purple">param2</font></i> = Scale ID,
</dd></dl>
<dl><dd><i><font color="green">param3</font></i> = Method ID,
</dd></dl>
<dl><dd><i><font color="orange">param4</font></i> = Study ID (set to 0 (zero) if querying across all studies),
</dd></dl>
<dl><dd><i><font color="navy">param5</font></i> = Dataset No./Representation No. (set to 0 (zero) if querying across all studies),
</dd></dl>
<dl><dd><i><font color="brown">param6</font></i> = 'ASC' or 'DESC' (sorting scheme: ascending or descending?)
</dd></dl>
<a name="Details" id="Details"></a><h4> <span class="mw-headline"> Details  </span></h4>
<dl><dd><dl><dd><dl><dd><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue"></font><font color="blue">
<ol><li>3 warehouse tables have been created.<br /></font> 
</li></ol>
</dd></dl>
</dd></dl>
</dd></dl>
<font color="blue"><div class="center"><div class="floatnone"><a href="../../../../articles/i/c/i/File%7EIcis_proposed_warehouse.JPG_1584.html" class="image" title="Icis proposed warehouse.JPG"><img alt="" src="../../../../images/b/b4/Icis_proposed_warehouse.JPG" width="465" height="367" border="0" /></a></div></div></font> 
<p><br /> 
</p>
<dl><dd><dl><dd><dl><dd><dl><dd><font color="blue">1) <b>wh_datasets</b></font>
</dd></dl>
</dd></dl>
</dd></dl>
</dd></dl>
<pre>--
-- Table structure for table `wh_datasets` (MySQL)
--
--
DROP TABLE IF EXISTS `wh_datasets`;
CREATE TABLE `wh_datasets` (
 `study` int(11) default NULL,                <i>-- the study ID </i>
`dataset` int(11) default NULL,              <i>-- dataset number (a.k.a. REPRESNO)</i>
`maxrow` int(11) default NULL,              <i>-- maximum number of rows for the dataset</i>
`maxcol` int(11) default NULL,              <i>-- maximum number of columns for the dataset</i>
`desc`	varchar(255) default NULL     <i>-- description of the dataset</i>
) ENGINE=MyISAM DEFAULT CHARSET=utf8;
</pre>
<dl><dd><dl><dd><dl><dd><dl><dd><font color="blue">2) <b>wh_columns</b> - additional column FIELDID which contains the FACTOR ID (FACTORID) if the coltype = 'F' or VARIATE ID (VARIATID) if the coltype = 'V'</font>
</dd></dl>
</dd></dl>
</dd></dl>
</dd></dl>
<dl><dd><dl><dd><dl><dd><dl><dd><dl><dd>Sample data for table <b>wh_columns</b> (for <b>rice</b>) now on Castor (seeds.irri.org) server:
</dd></dl>
</dd></dl>
</dd></dl>
</dd></dl>
</dd></dl>
<div class="center"><div class="floatnone"><a href="../../../../articles/w/h/_/File%7EWh_columns.JPG_3e5b.html" class="image" title="Wh columns.JPG"><img alt="" src="../../../../images/e/e6/Wh_columns.JPG" width="1193" height="597" border="0" /></a></div></div> 
<pre>--
-- Table structure for table `wh_columns` (MySQL)
--
--
DROP TABLE IF EXISTS `wh_columns`;
CREATE TABLE `wh_columns` (
 `study` int(11) default NULL,              <i>-- the study ID</i>
`dataset` int(11) default NULL,            <i>-- this is the REPRESNO (representation number)</i> 
 `col` int(11) default NULL,                <i>-- column number (1 to n); 0 if coltype = "S" (study particulars) </i>
`colname` varchar(255) default NULL,       <i>-- column name</i>
`fieldid` int(11) default NULL,            <i>-- contains the FACTORID or VARIATID, depending on coltype</i>
`coltype` char(1) default NULL,            <i>-- "F" (factor) or "V" (variate) or "S" (STUDY particulars; for use in CropFinder)</i>
`valtype` char(1) default NULL,            <i>-- "C" if text, "N" if numeric</i>
`traitid` int(11) default NULL,            <i>-- link to TRAIT table</i>
`scaleid` int(11) default NULL,            <i>-- link to SCALE table</i>
`tmethid` int(11) default NULL           <i> -- link to TMETHOD table</i>
) ENGINE=MyISAM DEFAULT CHARSET=utf8;
</pre>
<dl><dd><dl><dd><dl><dd><dl><dd><font color="blue">3) <b>wh_data</b> - use only one column DATAVAL for storing values (VARCHAR(255) datatype), instead of one column (val_n) for numeric data and one column (val_c) for textual data</font> 
<dl><dd>Sample data for table <b>wh_data </b>(Note: records with dataval = NULL are removed)
</dd></dl>
</dd></dl>
</dd></dl>
</dd></dl>
</dd></dl>
<div class="center"><div class="floatnone"><a href="../../../../articles/w/h/_/File%7EWh_data.JPG_ce99.html" class="image" title="Wh data.JPG"><img alt="" src="../../../../images/a/ad/Wh_data.JPG" width="694" height="586" border="0" /></a></div></div> 
<pre>--
-- Table structure for table `wh_data` (MySQL)
--
--
DROP TABLE IF EXISTS `wh_data`;
CREATE TABLE `wh_data` (
 `study` int(11) default NULL,                <i>-- link to study ID in wh_columns table</i>
`dataset` int(11) default NULL,              <i>-- link to dataset # in wh_columns table</i>
`ounitid` int(11) default NULL,              <i>-- link to OINDEX table</i>
`datarow` int(11) default NULL,              <i>-- row number (1 to n)</i>
`datacol` int(11) default NULL,              <i>-- column number (1 to n)</i>
`dataval`	varchar(255) default NULL    <i>-- the data value</i>
) ENGINE=MyISAM DEFAULT CHARSET=utf8;
</pre>
<p><b>...</b> 
</p><p>... 
</p><p>...
</p>
<a name="More_information_.28GCP_website.29" id="More_information_.28GCP_website.29"></a><h2> <span class="mw-headline"> More information (GCP website) </span></h2>
<p><a href="http://pantheon.generationcp.org/index.php?option=com_content&amp;task=view&amp;id=546&amp;Itemid=293" class="external text" title="http://pantheon.generationcp.org/index.php?option=com_content&amp;task=view&amp;id=546&amp;Itemid=293" rel="nofollow">Deploying Koios-based ICIS Websites</a>
</p>
<!-- 
NewPP limit report
Preprocessor node count: 109/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->
<div class="printfooter">
Retrieved from "<a href="http://localhost../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html">http://localhost../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk"><a href="../../../../articles/c/o/m/Talk%7ECombining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_409e.html" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="../../../../articles/u/s/e/Special%7EUserLogin_94cd.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../../../../misc/icis-wiki3.png);" href="../../../../index.html" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="../../../../index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
				<li id="n-portal"><a href="../../../../articles/c/o/m/ICISWiki%7ECommunity_Portal_7449.html" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="../../../../articles/s/e/a/Special%7ESearch_a8e5.html" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search ICISWiki [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="../../../../articles/w/h/a/Special%7EWhatLinksHere_Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_95b2.html" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="../../../../articles/r/e/c/Special%7ERecentChangesLinked_Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_d1f2.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="../../../../articles/s/p/e/Special%7ESpecialPages_f12b.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="../../../../articles/t/h/e/Combining_Cropfinder_%26_Koios%7E_The_new_ICIS_web_applications_146c.html" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="/icis/skins/common/images/gnu-fdl.png" alt='GNU Free Documentation License 1.2' /></a></div>
			<ul id="f-list">
					<li id="credits">This page was last modified 02:08, 31 March 2009 by <a href="../../../../articles/m/h/a/User%7EMhabito_276f.html" title="User:Mhabito">Maria Corina de Luna Habito</a>. Based on work by <a href="../../../../articles/m/a/n/User%7EManacleto_937a.html" title="User:Manacleto">Mylah Rystie U. Anacleto</a>.</li>
					<li id="copyright">Content is available under <a href="../../../../../COPYING.html" class="external " title="../../../../../COPYING.html">GNU Free Documentation License 1.2</a>.</li>
					<li id="privacy"><a href="../../../../articles/p/r/i/ICISWiki%7EPrivacy_policy_0cbf.html" title="ICISWiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="../../../../articles/a/b/o/ICISWiki%7EAbout_53aa.html" title="ICISWiki:About">About ICISWiki</a></li>
					<li id="disclaimer"><a href="../../../../articles/g/e/n/ICISWiki%7EGeneral_disclaimer_9129.html" title="ICISWiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 336.814 secs. --></body></html>
