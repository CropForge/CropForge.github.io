<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.14.0" />
		<meta name="keywords" content="Synchronization of IWIS2-WPMS with IWIS3-CENTRAL-GMS" />
		<link rel="shortcut icon" href="../../../../misc/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="../../../../../opensearch_desc.php" title="ICISWiki (en)" />
		<link title="Creative Commons" type="application/rdf+xml" href="../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html" rel="alternate meta" />
		<link rel="copyright" href="../../../../../COPYING.html" />
		<link rel="alternate" type="application/rss+xml" title="ICISWiki RSS Feed" href="http://localhost../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" />
		<link rel="alternate" type="application/atom+xml" title="ICISWiki Atom Feed" href="http://localhost../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" />
		<title>Synchronization of IWIS2-WPMS with IWIS3-CENTRAL-GMS - ICISWiki</title>
		<link rel="stylesheet" href="../../../../skins/common/shared.css?195" type="text/css" media="screen" />
		<link rel="stylesheet" href="../../../../skins/common/commonPrint.css?195" type="text/css" media="print" />
		<link rel="stylesheet" href="../../../../skins/monobook/main.css?195" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="../../../../skins/monobook/IE50Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="../../../../skins/monobook/IE55Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="../../../../skins/monobook/IE60Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="../../../../skins/monobook/IE70Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7ECommon.css?195" type="text/css" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7EPrint.css?195" type="text/css" media="print" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/MediaWiki%7EMonobook.css?195" type="text/css" />
		<link rel="stylesheet" href="../../../../skins/../../../../raw/gen.css?195" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="../../../../skins/common/IEFixes.js?195"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "../../../../skins";
		var wgArticlePath = "../../../../$1";
		var wgScriptPath = "../../../../..";
		var wgScript = "/icis/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://localhost";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS";
		var wgTitle = "Synchronization of IWIS2-WPMS with IWIS3-CENTRAL-GMS";
		var wgAction = "view";
		var wgArticleId = "2083";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = "9065";
		var wgVersion = "1.14.0";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="../../../../skins/common/wikibits.js?195"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="../../../../raw/gen.js"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Synchronization of IWIS2-WPMS with IWIS3-CENTRAL-GMS</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From ICISWiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1"><a href="#Pedigree_Parsing"><span class="tocnumber">2</span> <span class="toctext">Pedigree Parsing</span></a>
<ul>
<li class="toclevel-2"><a href="#Parsing_records_from_the_IWIS2_Crosses_Table_.28SID.3D0.29"><span class="tocnumber">2.1</span> <span class="toctext">Parsing records from the IWIS2 Crosses Table (SID=0)</span></a></li>
<li class="toclevel-2"><a href="#The_Algorithm_for_IWIS_records_with_SID.3D0"><span class="tocnumber">2.2</span> <span class="toctext">The Algorithm for IWIS records with SID=0</span></a></li>
<li class="toclevel-2"><a href="#The_Algorithm_for_Parsing_IWIS2_selections_.28SID.3C.3E0.29"><span class="tocnumber">2.3</span> <span class="toctext">The Algorithm for Parsing IWIS2 selections (SID&lt;&gt;0)</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Keeping_Track_of_IWIS2_Changes_and_synchronizing_with_IWIS3_changes"><span class="tocnumber">3</span> <span class="toctext">Keeping Track of IWIS2 Changes and synchronizing with IWIS3 changes</span></a></li>
<li class="toclevel-1"><a href="#Uploading_the_Changes"><span class="tocnumber">4</span> <span class="toctext">Uploading the Changes</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Introduction" id="Introduction"></a><h2> <span class="mw-headline">Introduction</span></h2>
<p>An IWIS3 clone has been added to the IWIS2 SQL-Server database together with bridging tables to link IWIS locations to ICIS locations and log synchronization clashes between IWIS2 and IWIS3.
</p><p>A program written by Jesper Norgaard in Transact SQL for the SQL Server database is triggered whenever IWIS2 is updated and this program updates the IWIS3 clone.
</p>
<a name="Pedigree_Parsing" id="Pedigree_Parsing"></a><h2> <span class="mw-headline">Pedigree Parsing</span></h2>
<p>All IWIS2 germplasm are recognized in IWIS3 by having non zero values of CID and SID fields in the GERMPLSM table (Non ICIS2 germplasm records must have these fields set to zero). In addition the IWIS3 clone has a field GCHANGE in the GERMPLSM table which is set to zero after each upload of the IWIS2 local to the IWIS3-CENTRAL. If a new germplasm record is added (a new CID, SID is entered into IWIS2) then a new germplasm record is added to the IWIS3 clone and the GCHANGE field is set to -1.
</p>
<a name="Parsing_records_from_the_IWIS2_Crosses_Table_.28SID.3D0.29" id="Parsing_records_from_the_IWIS2_Crosses_Table_.28SID.3D0.29"></a><h3> <span class="mw-headline">Parsing records from the IWIS2 Crosses Table (SID=0)</span></h3>
<p>IWIS2 germplasm with the following characteristics 
</p>
<ul><li> SID=0
</li><li> No BCID
</li><li> usually a cultivar name (The preferred name of an IWIS2 entry with CID&gt;0 and SID=0 is identified with an IWIS3 Cultivar name (NTYPE=6))
</li><li> often an introduction number 
</li></ul>
<p>are regarded as inbred lines not crosses.
</p><p>The lines themselves are identified with IWIS3 Imports (correspond to method 62) unless they have an IWIS2 Introduction Number in which case they are IWIS3 collection lines (method 255). If parents are given, a new IWIS3 record is generated representing the cross of those parents according to the cross rules below. (The CID of this new record is set to -1*CID of the original line)
</p><p>Generally, IWIS2 lines with SID=0 which
</p>
<ul><li> Have a CIMMYT BCID and
</li><li> Do not have Introduction Numbers 
</li></ul>
<p>are non-inbred crosses (F1) in IWIS3
</p><p>However, there are cases of germplasm in IWIS2 with SID=0 having BCIDs and Cultivar names and/or introduction numbers. Some of these are imported lines and some are CIMMYT crosses to which introduction numbers have been erroneously associated. There also appear to be some CIMMYT crosses without BCIDs 
</p>
<pre>Example (constructed):  GYLDENKAAL
GID=156 has parents GPID1=287 and GPID2=355. GID=156 was already known.
Preferred name GYLDENKAAL
It has no ACCNO
It has no BCID
Name for GID=287 is "287"
Name for GID=355 is "355"

before GID=156 GPID1=287 GPID2=355 method 102(example)
name for GID=156 AMARILLO

now GID=156 GPID1=4275375 GPID2=0 method 62, GNPGS=-1
GID=4275375 GPID1=287 GPID2=355 method 102(example)
name for GID=156 AMARILLO
name for GID=4275375 "287/355" 
</pre>
<p>Assumptions above:  All CIMMYT Crosses were given BCIDs and imports were not
(we know that the first assumptions has a number of exceptions,
there could be some that was actually given a BCID but are
imports, but they will be handled as an F1).
</p>
<a name="The_Algorithm_for_IWIS_records_with_SID.3D0" id="The_Algorithm_for_IWIS_records_with_SID.3D0"></a><h3> <span class="mw-headline">The Algorithm for IWIS records with SID=0</span></h3>
<p>Use IWIS3 Method 255 - COLLECTION LINE SF,
Method 62 â€“ IMPORT and
Methods 101, 102, 103, 106, 107 and 2 â€“ bi-parental cross types.
</p>
<pre>1. Does it have ACCNO?
  No -&gt; 2
  Yes, METHOD=255 GNPGS=-1
  1.1 Does it have parents?
     Yes, ADD a cross, give it the A/B cross name, finished
     No, finished

2. Does it have a BCID?
  Yes -&gt; 4
  No -&gt; 3

3. Does it have a preferred name for SID=0?
  No -&gt; 4
  Yes, METHOD=62 GNPGS=-1
     Does it have parents?
     Yes  -&gt; 1.1
     No  -&gt; finished

4. Determine which type 107, 106, 103, 102, 101, 2 (in that order):

Backcross (method 107) in IWIS2 determine by cross type M or F
(definition: When male parent of female is male of cross, or female 
parent of male is female of cross)

If not backcross, apply either of the following 5 methods:

(1) Single cross (method 101) 
    Both parents are inbred lines (see above)
(2) Three-way cross (method 102)
    Has one inbred parent and one F1 parent (not backcross)
(3) Double cross (method 103)
    Both parents are F1s (not backrosses)
(4) Complex cross (method 106)
    One or both parents are backrosses
(5) Unknown generative method (method 2)
    Use when a cross does not comply with 101, 102, 103, 106 or 107
    GNPGS = 2
</pre>
<a name="The_Algorithm_for_Parsing_IWIS2_selections_.28SID.3C.3E0.29" id="The_Algorithm_for_Parsing_IWIS2_selections_.28SID.3C.3E0.29"></a><h3> <span class="mw-headline">The Algorithm for Parsing IWIS2 selections (SID&lt;&gt;0)</span></h3>
<p>IWIS2 records with SID&lt;&gt;0 are selections which correspond to IWIS3 derivative methods. Algorithm to determine selection type:
</p>
<pre>(1) Single Plant Selection (method 205)
    Selection with SNU &gt; 0
(2) Selected bulk (method 206)
    Selection with SNU = 0
(3) Random bulk (method 207)
    Selection with SNU &lt; 0
</pre>
<p>Non-standard Selection Histories in CIMMYT are used for two purposes:
</p>
<ul><li> To save selection histories with a non-standard format
</li><li> To save selections with no selection history but one or several names attached, when nothing is known about the origin of the material, but it is not necessarily a cross
</li></ul>
<p>The unknown derivative method (method 31) is used for these.
</p>
<a name="Keeping_Track_of_IWIS2_Changes_and_synchronizing_with_IWIS3_changes" id="Keeping_Track_of_IWIS2_Changes_and_synchronizing_with_IWIS3_changes"></a><h2> <span class="mw-headline">Keeping Track of IWIS2 Changes and synchronizing with IWIS3 changes</span></h2>
<p>If a germplasm record is changed in IWIS2, the synchronization program checks the IWIS3, CHANGES table to see whether the existing IWIS3 record has been updated by a non IWIS2 user.  If so it logs a report of the requested change to a report table, SYNCREP.  If not, it makes the equivalent change to the IWIS3 record and increases or decreases the GCHANGE field values by one depending on whether its current value is &lt;0 or &gt;=0. If the required change is a deletion the GCHANGE field value is set to -999. CHANGE records are added to the ICIS CHANGES table so that the IWIS3-CENTRAL database can be updated with the same changes. 
</p><p>Names extracted from IWIS2 are uniquely identified by GID NTYPE and NVAL. The NAMES table in the IWIS3 clone has an NCHANGE field which is set to zero after each update.  If new names are added to IWIS2, for new or old germplasm, then equivalent records are added to the IWIS3 clone with the NCHANGE Field set to â€“ 1.  If a name is changed in IWIS2, then a check is made in the changes table of IWIS3 to see if external changes have been made to that name.  If so, a report of the required IWIS2 change is logged to the SYNCREP table. If not the corresponding change is made in the IWIS3 clone database and the NCHANGE filed is increased or decreased by 1 depending on whether its current value is &gt;= 0 or &lt; 0.  If a name is deleted from IWIS2, the corresponding NAMES NCHANGE field is set to -999. CHANGE records are added to the ICIS CHANGES table so that the IWIS3-CENTRAL database can be updated with the same changes.
</p><p>An exactly similar situation pertains to the ATRIBUTS table in the IWIS3 clone database with the extra field ACHANGE.
</p>
<a name="Uploading_the_Changes" id="Uploading_the_Changes"></a><h2> <span class="mw-headline">Uploading the Changes</span></h2>
<p>At each IWIS2 to IWIS3 upload, all records with non zero GCHANGE, NCHANGE and ACHANGE fields will be exported to an ACCESS database.  A series of queries will be run on the records that are downloaded to construct a formal ICIS local database by adding new records and generating CHANGE records for existing IWIS3 records. The SYNCREP reports will be manually interpreted to merge IWIS2 and external changes creating change records in the local database as required.  Finally the local database is uploaded to IWIS3-CENTRAL in the usual way and the IWIS3 clone in the IWIS2 SQL Server database is refreshed with the GCHANGE, NCHANGE and ACHANGE fields set to zero.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 8/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->
<div class="printfooter">
Retrieved from "<a href="http://localhost../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html">http://localhost../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="../../../../articles/s/y/n/Talk%7ESynchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_1686.html" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="../../../../articles/u/s/e/Special%7EUserLogin_94cd.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../../../../misc/icis-wiki3.png);" href="../../../../index.html" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="../../../../index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
				<li id="n-portal"><a href="../../../../articles/c/o/m/ICISWiki%7ECommunity_Portal_7449.html" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="../../../../articles/r/e/c/Special%7ERecentChanges_e0d0.html" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="../../../../articles/s/e/a/Special%7ESearch_a8e5.html" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search ICISWiki [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="../../../../articles/w/h/a/Special%7EWhatLinksHere_Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_3093.html" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="../../../../articles/r/e/c/Special%7ERecentChangesLinked_Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_5c04.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="../../../../articles/s/p/e/Special%7ESpecialPages_f12b.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="../../../../articles/s/y/n/Synchronization_of_IWIS2-WPMS_with_IWIS3-CENTRAL-GMS_0e51.html" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="/icis/skins/common/images/gnu-fdl.png" alt='GNU Free Documentation License 1.2' /></a></div>
			<ul id="f-list">
					<li id="credits">This page was last modified 20:14, 4 November 2007 by <a href="../../../../articles/j/n/o/User%7EJnorgaard_e415.html" title="User:Jnorgaard">Jesper NÃ¸rgaard Welen</a>. Based on work by <a href="../../../../articles/g/m/c/User%7EGmclaren_b845.html" title="User:Gmclaren">Graham McLaren</a>.</li>
					<li id="copyright">Content is available under <a href="../../../../../COPYING.html" class="external " title="../../../../../COPYING.html">GNU Free Documentation License 1.2</a>.</li>
					<li id="privacy"><a href="../../../../articles/p/r/i/ICISWiki%7EPrivacy_policy_0cbf.html" title="ICISWiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="../../../../articles/a/b/o/ICISWiki%7EAbout_53aa.html" title="ICISWiki:About">About ICISWiki</a></li>
					<li id="disclaimer"><a href="../../../../articles/g/e/n/ICISWiki%7EGeneral_disclaimer_9129.html" title="ICISWiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 85.126 secs. --></body></html>
